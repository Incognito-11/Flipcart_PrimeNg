<div class="product-management">
  <div class="header">
    <h2>Product Management</h2>
    <button pButton label="Add Product" icon="pi pi-plus" (click)="showAddDialog()"></button>
  </div>

  <p-table [value]="products" [paginator]="true" [rows]="5" [loading]="loading" responsiveLayout="scroll">
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Stock</th>
        <th>Category</th>
        <th>Brand</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-product>
      <tr>
        <td>{{ product.name }}</td>
        <td>â‚¹{{ product.price }}</td>
        <td>{{ product.stock }}</td>
        <td>{{ product.category }}</td>
        <td>{{ product.brand }}</td>
        <td>
          <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text"
            (click)="showEditDialog(product)"></button>
          <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-danger"
            (click)="confirmDelete(product)"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <!-- Form Dialog -->
  <p-dialog header="{{ isEditMode ? 'Edit Product' : 'Add Product' }}" [(visible)]="displayDialog" [modal]="true"
    [closable]="false" [responsive]="true" [style]="{ width: '400px' }">
    <form [formGroup]="productForm" (ngSubmit)="saveProduct()">
      <div class="p-fluid">
        <div class="p-field" *ngFor="let field of [
            { label: 'Name', name: 'name', type: 'text' },
            { label: 'Description', name: 'description', type: 'textarea' },
            { label: 'Price', name: 'price', type: 'number' },
            { label: 'Stock', name: 'stock', type: 'number' },
            { label: 'Brand', name: 'brand', type: 'text' },
            { label: 'Image URL', name: 'imageUrl', type: 'text' },
            { label: 'Rating', name: 'rating', type: 'number' },
            { label: 'Discount (%)', name: 'discount', type: 'number' }
          ]">
          <label [for]="field.name">{{ field.label }}</label>
          <textarea *ngIf="field.type === 'textarea'" pInputTextarea rows="2" [id]="field.name"
            [formControlName]="field.name"></textarea>
          <input *ngIf="field.type !== 'textarea'" pInputText [type]="field.type" [id]="field.name"
            [formControlName]="field.name" />
        </div>

        <div class="p-field">
          <label for="category">Category</label>
          <p-dropdown id="category" [options]="categories" optionLabel="name" optionValue="name"
            placeholder="Select a category" formControlName="category">
          </p-dropdown>
        </div>
      </div>

      <div class="dialog-footer">
        <button pButton type="submit" label="Save" [disabled]="productForm.invalid"></button>
        <button pButton label="Cancel" class="p-button-secondary" (click)="displayDialog = false"
          type="button"></button>
      </div>
    </form>
  </p-dialog>

  <p-toast></p-toast>
</div>